import{_ as t}from"../../chunks/preload-helper-08cc8e69.js";import{S as e,i as s,s as n,e as o,t as a,k as r,c as i,a as c,g as l,d as u,o as d,b as h,f,K as p,E as v,F as m,U as y,Z as g,X as x,_ as E,h as b,G as w,B as k}from"../../chunks/vendor-d81b028b.js";import{A as j,u as _}from"../../chunks/Env-edee670d.js";import{g as I}from"../../chunks/navigation-2ffed81e.js";import"../../chunks/singletons-12a22614.js";function T(t){let e,s,n,g,x,E,b,w;return{c(){e=o("p"),s=o("button"),n=a("อัพเดท"),g=r(),x=o("button"),E=a("ลบ"),this.h()},l(t){e=i(t,"P",{class:!0});var o=c(e);s=i(o,"BUTTON",{class:!0});var a=c(s);n=l(a,"อัพเดท"),a.forEach(u),g=d(o),x=i(o,"BUTTON",{class:!0});var r=c(x);E=l(r,"ลบ"),r.forEach(u),o.forEach(u),this.h()},h(){h(s,"class","bg-blue-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(x,"class","bg-red-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(e,"class","my-2 flex justify-center items-center gap-3")},m(o,a){f(o,e,a),p(e,s),p(s,n),p(e,g),p(e,x),p(x,E),b||(w=[v(s,"click",t[4]),v(x,"click",t[3])],b=!0)},p:m,d(t){t&&u(e),b=!1,y(w)}}}function B(t){var e,s;let n,v,y,w,k,j,_,I,B,D,P,$,A,N,L,O,S,U=t[0].title+"",V=(null==(e=t[0].author)?void 0:e.username)+"",K=t[0].url+"",z=t[2]&&(null==(s=t[0].author)?void 0:s.username)===t[2].username&&T(t);return{c(){n=o("link"),v=r(),y=o("h1"),w=a(U),k=r(),j=o("p"),_=a("By: "),I=a(V),B=r(),z&&z.c(),D=r(),P=o("div"),$=o("div"),A=o("a"),N=a(K),O=r(),S=new g,this.h()},l(t){const e=x('[data-svelte="svelte-1lp6hy5"]',document.head);n=i(e,"LINK",{rel:!0,href:!0}),e.forEach(u),v=d(t),y=i(t,"H1",{class:!0});var s=c(y);w=l(s,U),s.forEach(u),k=d(t),j=i(t,"P",{class:!0});var o=c(j);_=l(o,"By: "),I=l(o,V),o.forEach(u),B=d(t),z&&z.l(t),D=d(t),P=i(t,"DIV",{class:!0});var a=c(P);$=i(a,"DIV",{class:!0});var r=c($);A=i(r,"A",{href:!0});var h=c(A);N=l(h,K),h.forEach(u),O=d(r),S=E(r),r.forEach(u),a.forEach(u),this.h()},h(){h(n,"rel","stylesheet"),h(n,"href","https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.4.x/dist/typography.min.css"),h(y,"class","text-center text-4xl mt-4"),h(j,"class","text-center mt-2"),h(A,"href",L=t[0].url),S.a=null,h($,"class","prose lg:prose-xl max-w-none"),h(P,"class","border border-gray-500 my-4 mx-8 p-6 rounded ")},m(e,s){p(document.head,n),f(e,v,s),f(e,y,s),p(y,w),f(e,k,s),f(e,j,s),p(j,_),p(j,I),f(e,B,s),z&&z.m(e,s),f(e,D,s),f(e,P,s),p(P,$),p($,A),p(A,N),p($,O),S.m(t[1],$)},p(t,[e]){var s,n;1&e&&U!==(U=t[0].title+"")&&b(w,U),1&e&&V!==(V=(null==(s=t[0].author)?void 0:s.username)+"")&&b(I,V),t[2]&&(null==(n=t[0].author)?void 0:n.username)===t[2].username?z?z.p(t,e):(z=T(t),z.c(),z.m(D.parentNode,D)):z&&(z.d(1),z=null),1&e&&K!==(K=t[0].url+"")&&b(N,K),1&e&&L!==(L=t[0].url)&&h(A,"href",L),2&e&&S.p(t[1])},i:m,o:m,d(t){u(n),t&&u(v),t&&u(y),t&&u(k),t&&u(j),t&&u(B),z&&z.d(t),t&&u(D),t&&u(P)}}}var D=function(t,e,s,n){return new(s||(s=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,i)}c((n=n.apply(t,e||[])).next())}))};const P=({page:{params:t},fetch:e})=>D(void 0,void 0,void 0,(function*(){const{slug:s}=t,n=yield e(`${j}/posts/`+s);if(404===n.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}return{props:{post:yield n.json()}}}));function $(e,s,n){let o;w(e,_,(t=>n(2,o=t)));var a=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,i)}c((n=n.apply(t,e||[])).next())}))};let{post:r}=s,i=r.content;k((()=>a(void 0,void 0,void 0,(function*(){const e=(yield t((()=>import("../../chunks/vendor-d81b028b.js").then((function(t){return t.m}))),[])).default;n(1,i=e(r.content))}))));return e.$$set=t=>{"post"in t&&n(0,r=t.post)},[r,i,o,function(){var t,e,s,n;return a(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void I("/auth/login");const o=yield fetch(`${j}/posts/`+r.id,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token")}});if(o.ok)I("/");else{const a=yield o.json();(null===(n=null===(s=null===(e=null===(t=null==a?void 0:a.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===n?void 0:n.message)&&alert(a.message[0].messages[0].message)}}))},()=>I("/posts/new?edit="+r.id)]}class A extends e{constructor(t){super(),s(this,t,$,B,n,{post:0})}}export{A as default,P as load};
