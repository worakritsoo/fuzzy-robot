import{_ as t}from"../../chunks/preload-helper-08cc8e69.js";import{S as e,i as s,s as o,k as n,e as i,t as a,X as r,d as l,o as c,c as d,a as u,g as v,b as p,f,K as h,R as m,E as g,T as y,F as E,U as I,G as x,B as T,Y as b}from"../../chunks/vendor-d81b028b.js";import{A as j,u as w}from"../../chunks/Env-edee670d.js";import{g as k}from"../../chunks/navigation-2ffed81e.js";import"../../chunks/singletons-12a22614.js";function A(t){let e,s,o,x,T,b,j,w,k,A,L,D,$,B,P,S,V,_,N,O,U,R,M,z,C,F,H,J,X,q,G,K,Y,Q,W;return document.title=e=t[1],{c(){s=n(),o=i("div"),x=i("form"),T=i("div"),b=i("label"),j=a("ชื่อเรื่อง"),w=n(),k=i("input"),A=n(),L=i("div"),D=i("label"),$=a("ลิ้งค์"),B=n(),P=i("input"),S=n(),V=i("div"),_=i("label"),N=a("คำอธิบายสั้นๆ"),O=n(),U=i("input"),R=n(),M=i("div"),z=i("label"),C=a("เนื้อหา"),F=n(),H=i("textarea"),J=n(),X=i("div"),q=i("button"),G=a("บันทึก"),K=n(),Y=i("div"),this.h()},l(t){r('[data-svelte="svelte-1258swp"]',document.head).forEach(l),s=c(t),o=d(t,"DIV",{class:!0});var e=u(o);x=d(e,"FORM",{class:!0});var n=u(x);T=d(n,"DIV",{class:!0});var i=u(T);b=d(i,"LABEL",{for:!0,class:!0});var a=u(b);j=v(a,"ชื่อเรื่อง"),a.forEach(l),w=c(i),k=d(i,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),i.forEach(l),A=c(n),L=d(n,"DIV",{class:!0});var p=u(L);D=d(p,"LABEL",{for:!0,class:!0});var f=u(D);$=v(f,"ลิ้งค์"),f.forEach(l),B=c(p),P=d(p,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),p.forEach(l),S=c(n),V=d(n,"DIV",{class:!0});var h=u(V);_=d(h,"LABEL",{for:!0,class:!0});var m=u(_);N=v(m,"คำอธิบายสั้นๆ"),m.forEach(l),O=c(h),U=d(h,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),h.forEach(l),R=c(n),M=d(n,"DIV",{class:!0});var g=u(M);z=d(g,"LABEL",{for:!0,class:!0});var y=u(z);C=v(y,"เนื้อหา"),y.forEach(l),F=c(g),H=d(g,"TEXTAREA",{rows:!0,placeholder:!0,id:!0,class:!0}),u(H).forEach(l),g.forEach(l),J=c(n),X=d(n,"DIV",{class:!0});var E=u(X);q=d(E,"BUTTON",{class:!0,type:!0});var I=u(q);G=v(I,"บันทึก"),I.forEach(l),E.forEach(l),n.forEach(l),K=c(e),Y=d(e,"DIV",{class:!0}),u(Y).forEach(l),e.forEach(l),this.h()},h(){p(b,"for","title"),p(b,"class","svelte-1gr50x2"),p(k,"type","text"),p(k,"placeholder","พิมพ์ชื่อเรื่อง"),p(k,"id","title"),p(k,"class","svelte-1gr50x2"),p(T,"class","my-1"),p(D,"for","url"),p(D,"class","svelte-1gr50x2"),p(P,"type","url"),p(P,"placeholder","เป็น http(s)://"),p(P,"id","url"),p(P,"class","svelte-1gr50x2"),p(L,"class","my-1"),p(_,"for","description"),p(_,"class","svelte-1gr50x2"),p(U,"type","text"),p(U,"placeholder","Enter description"),p(U,"id","description"),p(U,"class","svelte-1gr50x2"),p(V,"class","my-1"),p(z,"for","title"),p(z,"class","svelte-1gr50x2"),p(H,"rows",5),p(H,"placeholder","เพิ่มเนื้อหาที่นี่"),p(H,"id","content"),p(H,"class","svelte-1gr50x2"),p(M,"class","my-1"),p(q,"class","submit svelte-1gr50x2"),p(q,"type","submit"),p(X,"class","my-2"),p(x,"class","my-4 mx-auto container p-4"),p(Y,"class","prose md:prose-md w-full"),p(o,"class","md:flex")},m(e,n){f(e,s,n),f(e,o,n),h(o,x),h(x,T),h(T,b),h(b,j),h(T,w),h(T,k),m(k,t[1]),h(x,A),h(x,L),h(L,D),h(D,$),h(L,B),h(L,P),m(P,t[3]),h(x,S),h(x,V),h(V,_),h(_,N),h(V,O),h(V,U),m(U,t[2]),h(x,R),h(x,M),h(M,z),h(z,C),h(M,F),h(M,H),m(H,t[0]),h(x,J),h(x,X),h(X,q),h(q,G),h(o,K),h(o,Y),Y.innerHTML=t[4],Q||(W=[g(k,"input",t[7]),g(P,"input",t[8]),g(U,"input",t[9]),g(H,"input",t[10]),g(x,"submit",y(t[5]))],Q=!0)},p(t,[s]){2&s&&e!==(e=t[1])&&(document.title=e),2&s&&k.value!==t[1]&&m(k,t[1]),8&s&&m(P,t[3]),4&s&&U.value!==t[2]&&m(U,t[2]),1&s&&m(H,t[0]),16&s&&(Y.innerHTML=t[4])},i:E,o:E,d(t){t&&l(s),t&&l(o),Q=!1,I(W)}}}var L=function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{l(o.next(t))}catch(e){i(e)}}function r(t){try{l(o.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,r)}l((o=o.apply(t,e||[])).next())}))};const D=({fetch:t,page:{query:e}})=>L(void 0,void 0,void 0,(function*(){const s=e.get("edit");if(s){const e=yield t(j+"/posts/"+s);if(404===e.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}{const t=yield e.json();return{props:{editId:s,title:t.title,url:t.url,content:t.content,description:t.description}}}}return{props:{}}}));function $(e,s,o){let n,i;x(e,w,(t=>o(12,i=t)));var a=this&&this.__awaiter||function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{l(o.next(t))}catch(e){i(e)}}function r(t){try{l(o.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,r)}l((o=o.apply(t,e||[])).next())}))};let{editId:r}=s,{title:l=""}=s,{description:c=""}=s,{content:d=""}=s,{url:u=""}=s;return T((()=>a(void 0,void 0,void 0,(function*(){i||k("/login"),(yield t((()=>import("../../chunks/vendor-d81b028b.js").then((function(t){return t.m}))),[])).default})))),e.$$set=t=>{"editId"in t&&o(6,r=t.editId),"title"in t&&o(1,l=t.title),"description"in t&&o(2,c=t.description),"content"in t&&o(0,d=t.content),"url"in t&&o(3,u=t.url)},e.$$.update=()=>{1&e.$$.dirty&&o(4,n=b(d))},[d,l,c,u,n,function(){var t,e,s,o;return a(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void k("/auth");if(r)return void function(){var t,e,s,o;a(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void k("/auth");const n=yield fetch(`${j}/posts/`+r,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:l,description:c,content:d,url:u})});if(n.ok){const t=yield n.json();k("/posts/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))}();const n=yield fetch(`${j}/posts`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:l,description:c,content:d,url:u})});if(n.ok){const t=yield n.json();k("/posts/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))},r,function(){l=this.value,o(1,l)},function(){u=this.value,o(3,u)},function(){c=this.value,o(2,c)},function(){d=this.value,o(0,d)}]}class B extends e{constructor(t){super(),s(this,t,$,A,o,{editId:6,title:1,description:2,content:0,url:3})}}export{B as default,D as load};
